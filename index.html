<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R.D.F - النظام الآمن غير القابل للتجاوز</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ... (نفس التصميم السابق) ... */
    </style>
</head>
<body>
    <!-- ... (نفس الهيكل السابق) ... -->
    
    <script>
        // ... (بيانات الأعضاء وكلمات المرور العشوائية) ...
        
        // تقنيات متعددة لإنشاء بصمة فريدة للمستخدم
        async function createAdvancedFingerprint() {
            const components = [];
            
            // 1. معلومات المتصفح والجهاز
            components.push(navigator.userAgent);
            components.push(navigator.platform);
            components.push(navigator.language);
            components.push(navigator.hardwareConcurrency);
            components.push(screen.width + 'x' + screen.height + 'x' + screen.colorDepth);
            
            // 2. معلومات الوقت والمنطقة
            const timezone = new Date().getTimezoneOffset();
            components.push(timezone);
            
            // 3. بصمة Canvas المتقدمة
            const canvas = document.createElement('canvas');
            if (canvas.getContext) {
                const ctx = canvas.getContext('2d');
                ctx.textBaseline = 'top';
                ctx.font = '14px Arial';
                ctx.fillStyle = '#f60';
                ctx.fillRect(125, 1, 62, 20);
                ctx.fillStyle = '#069';
                ctx.fillText('RDF_SECURE_SYSTEM', 2, 15);
                ctx.fillStyle = 'rgba(102, 204, 0, 0.7)';
                ctx.fillText('RDF_SECURE_SYSTEM', 4, 17);
                
                const canvasData = canvas.toDataURL();
                components.push(canvasData);
            }
            
            // 4. بصمة WebGL
            let webglData = '';
            if (window.WebGLRenderingContext) {
                try {
                    const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                    if (gl) {
                        const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                        if (debugInfo) {
                            webglData = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL) + '|' + 
                                        gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
                        }
                        components.push(webglData);
                    }
                } catch (e) {
                    console.error('WebGL error:', e);
                }
            }
            
            // 5. بصمة الصوت
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const analyser = audioContext.createAnalyser();
                
                oscillator.connect(analyser);
                analyser.connect(audioContext.destination);
                
                oscillator.start();
                const dataArray = new Uint8Array(analyser.frequencyBinCount);
                analyser.getByteFrequencyData(dataArray);
                oscillator.stop();
                
                components.push(dataArray.join(','));
            } catch (e) {
                console.error('Audio fingerprint error:', e);
            }
            
            // 6. تجميع البصمة وتجزئتها
            const combined = components.join('|');
            const encoder = new TextEncoder();
            const data = encoder.encode(combined);
            const hashBuffer = await crypto.subtle.digest('SHA-512', data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }
        
        // نظام التخزين المتعدد المقاوم للمسح
        class PersistentStorage {
            constructor() {
                this.storageKeys = [
                    'rdf_block_data',
                    'rdf_security_data',
                    'rdf_fingerprint_data'
                ];
            }
            
            // تخزين البيانات في أماكن متعددة
            async saveBlockData(data) {
                // 1. التخزين في localStorage
                localStorage.setItem(this.storageKeys[0], JSON.stringify(data));
                
                // 2. التخزين في IndexedDB
                await this.saveToIndexedDB(data);
                
                // 3. التخزين في SessionStorage
                sessionStorage.setItem(this.storageKeys[1], JSON.stringify(data));
                
                // 4. التخزين في ملفات الكوكيز
                this.setCookie(this.storageKeys[2], JSON.stringify(data), 365);
            }
            
            // استرجاع البيانات من أي مصدر متاح
            async getBlockData() {
                // 1. التحقق من localStorage
                const lsData = localStorage.getItem(this.storageKeys[0]);
                if (lsData) return JSON.parse(lsData);
                
                // 2. التحقق من IndexedDB
                const idbData = await this.getFromIndexedDB();
                if (idbData) return idbData;
                
                // 3. التحقق من SessionStorage
                const ssData = sessionStorage.getItem(this.storageKeys[1]);
                if (ssData) return JSON.parse(ssData);
                
                // 4. التحقق من الكوكيز
                const cookieData = this.getCookie(this.storageKeys[2]);
                if (cookieData) return JSON.parse(cookieData);
                
                return null;
            }
            
            // تخزين البيانات في IndexedDB
            async saveToIndexedDB(data) {
                return new Promise((resolve) => {
                    const request = indexedDB.open('RDF_SecureStorage', 1);
                    
                    request.onupgradeneeded = (event) => {
                        const db = event.target.result;
                        if (!db.objectStoreNames.contains('securityData')) {
                            db.createObjectStore('securityData');
                        }
                    };
                    
                    request.onsuccess = (event) => {
                        const db = event.target.result;
                        const transaction = db.transaction('securityData', 'readwrite');
                        const store = transaction.objectStore('securityData');
                        store.put(data, 'blockInfo');
                        resolve();
                    };
                    
                    request.onerror = () => resolve();
                });
            }
            
            // استرجاع البيانات من IndexedDB
            async getFromIndexedDB() {
                return new Promise((resolve) => {
                    const request = indexedDB.open('RDF_SecureStorage', 1);
                    
                    request.onsuccess = (event) => {
                        const db = event.target.result;
                        const transaction = db.transaction('securityData', 'readonly');
                        const store = transaction.objectStore('securityData');
                        const request = store.get('blockInfo');
                        
                        request.onsuccess = (e) => resolve(e.target.result);
                        request.onerror = () => resolve(null);
                    };
                    
                    request.onerror = () => resolve(null);
                });
            }
            
            // وظائف إدارة الكوكيز
            setCookie(name, value, days) {
                const date = new Date();
                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                const expires = "expires=" + date.toUTCString();
                document.cookie = name + "=" + value + ";" + expires + ";path=/";
            }
            
            getCookie(name) {
                const cookieName = name + "=";
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    let cookie = cookies[i];
                    while (cookie.charAt(0) === ' ') {
                        cookie = cookie.substring(1);
                    }
                    if (cookie.indexOf(cookieName) === 0) {
                        return cookie.substring(cookieName.length, cookie.length);
                    }
                }
                return null;
            }
        }

        // عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', async function() {
            // إنشاء بصمة متقدمة
            userFingerprint = await createAdvancedFingerprint();
            
            // تهيئة نظام التخزين المقاوم للمسح
            const persistentStorage = new PersistentStorage();
            const blockData = await persistentStorage.getBlockData();
            
            if (blockData && blockData.fingerprint === userFingerprint) {
                const currentTime = new Date().getTime();
                const remainingTime = blockData.blockedUntil - currentTime;
                
                if (remainingTime > 0) {
                    showBlockedMessage(remainingTime);
                    return;
                }
            }
            
            // ... (بقية كود التهيئة) ...
        });
        
        // حظر المستخدم مع التخزين المقاوم للمسح
        async function blockUser(username) {
            const persistentStorage = new PersistentStorage();
            const blockData = await persistentStorage.getBlockData() || {};
            
            const blockCount = blockData.blockCount || 0;
            const newBlockCount = blockCount + 1;
            const blockDuration = newBlockCount === 1 ? 15 : 30;
            const blockTime = blockDuration * 60 * 1000;
            
            const currentTime = new Date().getTime();
            const blockedUntil = currentTime + blockTime;
            
            const newBlockData = {
                fingerprint: userFingerprint,
                blockedUntil,
                blockCount: newBlockCount,
                lastUsername: username,
                timestamp: new Date().toISOString(),
                deviceInfo: navigator.userAgent,
                platform: navigator.platform
            };
            
            await persistentStorage.saveBlockData(newBlockData);
            showBlockedMessage(blockTime);
        }
        
        // ... (بقية الدوال مع تعديلات طفيفة) ...
    </script>
</body>
</html>